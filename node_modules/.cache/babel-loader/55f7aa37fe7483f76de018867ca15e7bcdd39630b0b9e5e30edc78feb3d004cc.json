{"ast":null,"code":"import React,{useEffect,useMemo,useRef,useState}from\"react\";import'../styles/App.css';import PostList from\"../components/PostList\";import MyButton from\"../components/UI/button/MyButton\";import PostForm from\"../components/PostForm\";import PostFilter from\"../components/PostFilter\";import MyModal from\"../components/UI/modal/MyModal\";import{usePosts}from\"../hooks/usePosts\";import PostService from\"../API/PostService\";import Loader from\"../components/UI/loader/Loader\";import{useFetching}from\"../hooks/useFetching\";import{getPageCount}from\"../utils/pages\";import Pagination from\"../components/UI/pagination/Pagination\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const defaultPosts=[{id:1,title:'Javascript',body:'Its programmer language'},{id:2,title:'Node.js',body:'I dont know what is it'},{id:3,title:'React',body:'Its amazing features on JS! I am learning React right now!'}];function Posts(){const[posts,setPosts]=useState([]);const[filter,setFilter]=useState({sort:'',query:''});const[modal,setModal]=useState(false);const sortedAndSearchePosts=usePosts(posts,filter.sort,filter.query);const[limit,setLimit]=useState(10);const[page,setPage]=useState(1);const[totalPages,setTotalPages]=useState(0);const[fetchPosts,isPostsLoading,postError]=useFetching(async(limit,page)=>{const response=await PostService.getAll(limit,page);setPosts(response.data);const totalCount=response.headers['x-total-count'];setTotalPages(getPageCount(totalCount,limit));});useEffect(()=>{fetchPosts(limit,page);},[]);const createPost=newPost=>{setPosts([...posts,newPost]);setModal(false);};const removePost=post=>{setPosts(posts.filter(p=>p.id!==post.id));};const changePage=page=>{setPage(page);fetchPosts(limit,page);};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(MyButton,{style:{marginTop:'30px'},onClick:()=>setModal(true),children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043F\\u043E\\u0441\\u0442\"}),/*#__PURE__*/_jsx(MyModal,{visible:modal,setVisible:setModal,children:/*#__PURE__*/_jsx(PostForm,{create:createPost})}),/*#__PURE__*/_jsx(\"hr\",{style:{margin:'15px 0'}}),/*#__PURE__*/_jsx(PostFilter,{filter:filter,setFilter:setFilter}),postError&&/*#__PURE__*/_jsxs(\"h1\",{children:[\"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \",postError]}),isPostsLoading?/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',marginTop:'50px'},children:/*#__PURE__*/_jsx(Loader,{})}):/*#__PURE__*/_jsx(PostList,{remove:removePost,posts:sortedAndSearchePosts,title:\"\\u041F\\u043E\\u0441\\u0442\\u044B \\u043F\\u0440\\u043E JS\"}),/*#__PURE__*/_jsx(Pagination,{page:page,changePage:changePage,totalPages:totalPages})]});}export default Posts;","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","PostList","MyButton","PostForm","PostFilter","MyModal","usePosts","PostService","Loader","useFetching","getPageCount","Pagination","jsx","_jsx","jsxs","_jsxs","defaultPosts","id","title","body","Posts","posts","setPosts","filter","setFilter","sort","query","modal","setModal","sortedAndSearchePosts","limit","setLimit","page","setPage","totalPages","setTotalPages","fetchPosts","isPostsLoading","postError","response","getAll","data","totalCount","headers","createPost","newPost","removePost","post","p","changePage","className","children","style","marginTop","onClick","visible","setVisible","create","margin","display","justifyContent","remove"],"sources":["/workspaces/quick-post/src/pages/Posts.jsx"],"sourcesContent":["import React, {useEffect, useMemo, useRef, useState } from \"react\";\r\nimport '../styles/App.css'\r\nimport PostList from \"../components/PostList\";\r\nimport MyButton from \"../components/UI/button/MyButton\";\r\nimport PostForm from \"../components/PostForm\";\r\nimport PostFilter from \"../components/PostFilter\";\r\nimport MyModal from \"../components/UI/modal/MyModal\";\r\nimport { usePosts } from \"../hooks/usePosts\";\r\nimport PostService from \"../API/PostService\";\r\nimport Loader from \"../components/UI/loader/Loader\";\r\nimport { useFetching } from \"../hooks/useFetching\";\r\nimport {getPageCount} from \"../utils/pages\"\r\nimport Pagination from \"../components/UI/pagination/Pagination\";\r\n\r\nconst defaultPosts = [\r\n  {id: 1, title: 'Javascript', body: 'Its programmer language'},\r\n  {id: 2, title: 'Node.js', body: 'I dont know what is it'},\r\n  {id: 3, title: 'React', body: 'Its amazing features on JS! I am learning React right now!'}\r\n]\r\n\r\nfunction Posts() {\r\n  const [posts, setPosts] = useState([])\r\n  const [filter, setFilter] = useState({sort: '', query: ''})\r\n  const [modal, setModal] = useState(false)\r\n  const sortedAndSearchePosts = usePosts(posts, filter.sort, filter.query)\r\n\r\n  const [limit, setLimit] = useState(10)\r\n  const [page, setPage] = useState(1)\r\n  const [totalPages, setTotalPages] = useState(0)\r\n  const [fetchPosts, isPostsLoading, postError] = useFetching(async (limit, page) =>{\r\n    const response = await PostService.getAll(limit, page);\r\n    setPosts(response.data)\r\n    const totalCount = response.headers['x-total-count']\r\n    setTotalPages(getPageCount(totalCount, limit))\r\n  })\r\n  \r\n  useEffect(() =>{\r\n    fetchPosts(limit, page)\r\n  }, [])\r\n\r\n  const createPost = (newPost) => {\r\n    setPosts([...posts, newPost])\r\n    setModal(false)\r\n  }\r\n\r\n  const removePost = (post) => {\r\n    setPosts(posts.filter(p => p.id !== post.id))\r\n  }\r\n\r\n  const changePage = (page) =>{\r\n    setPage(page)\r\n    fetchPosts(limit, page)\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <MyButton style={{marginTop: '30px'}} onClick={() => setModal(true)}>\r\n        Создать пост\r\n      </MyButton>\r\n      <MyModal visible={modal} setVisible={setModal}>\r\n        <PostForm create={createPost}></PostForm>\r\n      </MyModal>\r\n      <hr style={{margin: '15px 0'}}></hr>\r\n      <PostFilter filter={filter} setFilter={setFilter}></PostFilter>\r\n      {postError && <h1>Произошла ошибка {postError}</h1>}\r\n      {isPostsLoading\r\n      ? <div style={{display: 'flex', justifyContent: 'center', marginTop: '50px'}}><Loader></Loader></div>\r\n      : <PostList remove={removePost} posts={sortedAndSearchePosts} title=\"Посты про JS\"></PostList>}\r\n      <Pagination \r\n        page={page} \r\n        changePage={changePage} \r\n        totalPages={totalPages}>\r\n      </Pagination>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Posts;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}